{% extends 'base.html' %}

{% block body_class %}bg-leaf{% endblock %}

{% block title %}GardenCircle ‚Äî Pr√≠spevok{% endblock %}

{% block content %}
  <!-- Post Detail -->
  <section class="card">
    <div class="post-card">
      <div class="post-header">
        <div class="meta">
          <a href="{{ url_for('user_profile', username=post.author) }}" style="text-decoration: none; color: var(--primary-green);">
            <strong class="author">{{ post.author }}</strong>
          </a>
          <time class="time">{{ post.created_at }}</time>
        </div>
      </div>
      <div class="post-content">
        {{ post.content }}
      </div>
      {% if post.image_path %}
        <img src="{{ url_for('static', filename=post.image_path) }}" alt="Obr√°zok pr√≠spevku" loading="lazy">
      {% endif %}
        <div class="post-actions" style="display:flex; align-items:center; gap:.5rem; margin-top:.5rem;">
         <button id="likeBtn" class="btn btn-ghost like-btn {{ 'liked' if post.liked else '' }}" data-post-id="{{ post.id }}" aria-label="P√°ƒçi sa mi to">
           <span class="like-emoji">{{ '‚ù§Ô∏è' if post.liked else 'ü§ç' }}</span>
         </button>
         <span id="likeCount" class="like-count">{{ post.like_count or 0 }}</span>
        </div>
    </div>
  </section>

  <!-- Comments Section -->
  <section class="card">
    <header class="section-header">
      <h2>Koment√°re</h2>
      <p class="muted">ƒåo si o tom mysl√≠≈°?</p>
    </header>
    
    <ul class="comment-list">
      {% for c in comments %}
        <li>
          <strong>{{ c.author }}</strong>
          <span class="muted"> ‚Ä¢ {{ c.created_at }}</span>
          <div style="margin-top: var(--space-xs);">{{ c.text }}</div>
        </li>
      {% else %}
        <li class="muted text-center" style="padding: var(--space-lg);">
          Zatiaƒæ ≈æiadne koment√°re ‚Äî buƒè prv√Ω, kto komentuje!
        </li>
      {% endfor %}
    </ul>

    <form class="comment-form" method="post" action="{{ url_for('add_comment', post_id=post.id) }}">
      <div class="form-group">
        <textarea name="text" rows="3" placeholder="Nap√≠≈° koment√°r..." required style="margin-bottom: var(--space-md);"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Odosla≈• koment√°r</button>
    </form>
  </section>
{% endblock %}